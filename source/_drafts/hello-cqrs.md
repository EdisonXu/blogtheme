---
title: CQRS&Event Souring系列（一）——Hello
date: 2017-03-12 12:57:52
tags:
- axon
- CQRS
- eventsourcing
---
> 在研究微服务的过程中，跨服务的逻辑处理，尤其是带有事务性需要统一commit或rollback的，是比较麻烦的。看到一些先行者给出的方案是`CQRS`和`Event Sourcing`，于是乎开始了对这一块的了解。结果发现掉入一个“深坑”……原因是为了了解这两个东东，显然必须要了解历史，它们是怎么来的，为什么要有这两个概念，随着一层层抽丝剥茧，结合自己的领悟，最终发现到了哲学成名。。。。。。也是醉了。为了引导其他人也掉下来（这么好的坑，掉下来人越多越好呀），把一些基本概念和感悟放到这个系列的最前面，作为**必读**。有些朋友可能图快，想直接跳过这一章，去看后面具体的、可执行的东西，相信我，这一篇是“心法”，后面只是“招式”。

## 开始之前
你是否遇到过这种事？一个“好”工程师，非常喜欢学习和钻研新的技术知识，JEE时代学习Spring，SSH时代学习分布式，大数据时代又开始学习Hadoop,Storm,云时代开始搞docker,k8……然后成长为一名“架构师”了，在他的公司，有一个重要项目，于是乎他决意把这个项目设计成一个全分布式的系统，毕竟“时髦”嘛。每一个小的开发团队负责分布式中的一个服务。由于架构师对这些程序员缺乏必要的指导和控制，每个程序员只熟悉自己负责的一小块工作，彼此间缺乏沟通和协作，这个项目的`概念完整性`很快就被破坏了，他们开始自行其事，分布式服务间大量的远程调用导致了性能和可伸缩性等多方面的问题，开发、测试、运维的工作难度与日递增。慢慢的，项目的开发人员，离职的越来越多，包含最初的架构师，代码的维护越来越难，最终只能重构，将十几个分布式服务合并为三个相对独立的集中应用。最初良好的架构，到最后沦为废墟。

## 什么是EventSourcing?
记录发生的所有事件，通过回溯的方式，获取事物当前的状态。
可以想象一个时光轴的实现，它记录了一个用户从Day1发生的所有事件，然后进行统计和展示。另一个形象的类比：银行ATM账户。一个银行账户创建时必然有一个余额，然后每一次存取，这个余额都会发生增减变化。用户看到的是余额，银行内部必然有一个流水账，余额与流水账的计算结果一定是一致的，并且可以通过这一方式找到任一时间节点的余额情况。

## 什么是CQRS?
**CQRS**全称是`Command Query Responsibility Segregation`，即命令查询职责分离。
这个
